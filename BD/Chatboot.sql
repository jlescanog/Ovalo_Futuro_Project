-- Tabla de Preguntas Frecuentes (FAQs)
CREATE TABLE faqs (
    id SERIAL PRIMARY KEY,
    pregunta TEXT NOT NULL UNIQUE,
    respuesta TEXT NOT NULL,
    fecha_creacion TIMESTAMP DEFAULT NOW(),
    fecha_actualizacion TIMESTAMP DEFAULT NOW()
);

-- Tabla de Chats (cada sesión de conversación con el chatbot)
CREATE TABLE chats (
    id SERIAL PRIMARY KEY,
    usuario_id INT NULL,  -- Puede ser NULL si el chat es anónimo
    fecha_inicio TIMESTAMP DEFAULT NOW(),
    estado VARCHAR(20) DEFAULT 'activo', -- Valores: 'activo', 'finalizado', 'cancelado'
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id) ON DELETE SET NULL
);

-- Tabla de Mensajes del Chat
CREATE TABLE chat_messages (
    id SERIAL PRIMARY KEY,
    chat_id INT NOT NULL,
    usuario_id INT NULL,  -- NULL si el mensaje es del bot
    remitente VARCHAR(10) NOT NULL CHECK (remitente IN ('usuario', 'bot')),
    mensaje TEXT NOT NULL,
    fecha_envio TIMESTAMP DEFAULT NOW(),
    FOREIGN KEY (chat_id) REFERENCES chats(id) ON DELETE CASCADE,
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id) ON DELETE SET NULL
);

-- Índices para FAQs
CREATE INDEX idx_faqs_fecha_creacion ON faqs(fecha_creacion);

-- Índices para Chats
CREATE INDEX idx_chats_usuario_id ON chats(usuario_id);
CREATE INDEX idx_chats_estado ON chats(estado);

-- Índices para Chat_Messages
CREATE INDEX idx_chat_messages_chat_id ON chat_messages(chat_id);
CREATE INDEX idx_chat_messages_usuario_id ON chat_messages(usuario_id);
CREATE INDEX idx_chat_messages_fecha_envio ON chat_messages(fecha_envio);


INSERT INTO faqs (pregunta, respuesta, fecha_creacion, fecha_actualizacion)
VALUES
('¿Cómo consultar mis notas?', 'Para consultar tus notas, ingresa a tu perfil y haz clic en el apartado de notas.', NOW(), NOW()),
('¿Cómo consultar mi horario?', 'Tu horario se encuentra en el módulo de horarios de la plataforma.', NOW(), NOW()),
('¿Cómo pagar mis pensiones?', 'Puedes pagar tus pensiones a través del módulo de pagos.', NOW(), NOW()),
('¿Cómo actualizar mis datos personales?', 'Accede a tu perfil y edita la sección de datos personales.', NOW(), NOW()),
('¿Cómo contactar a mi profesor?', 'Los datos de contacto de tu profesor están disponibles en el módulo de cursos.', NOW(), NOW()),
('Pregunta 6', 'Respuesta 6', NOW(), NOW()),
('Pregunta 7', 'Respuesta 7', NOW(), NOW()),
('Pregunta 8', 'Respuesta 8', NOW(), NOW()),
('Pregunta 9', 'Respuesta 9', NOW(), NOW()),
('Pregunta 10', 'Respuesta 10', NOW(), NOW()),
('Pregunta 11', 'Respuesta 11', NOW(), NOW()),
('Pregunta 12', 'Respuesta 12', NOW(), NOW()),
('Pregunta 13', 'Respuesta 13', NOW(), NOW()),
('Pregunta 14', 'Respuesta 14', NOW(), NOW()),
('Pregunta 15', 'Respuesta 15', NOW(), NOW()),
('Pregunta 16', 'Respuesta 16', NOW(), NOW()),
('Pregunta 17', 'Respuesta 17', NOW(), NOW()),
('Pregunta 18', 'Respuesta 18', NOW(), NOW()),
('Pregunta 19', 'Respuesta 19', NOW(), NOW()),
('Pregunta 20', 'Respuesta 20', NOW(), NOW()),
('Pregunta 21', 'Respuesta 21', NOW(), NOW()),
('Pregunta 22', 'Respuesta 22', NOW(), NOW()),
('Pregunta 23', 'Respuesta 23', NOW(), NOW()),
('Pregunta 24', 'Respuesta 24', NOW(), NOW()),
('Pregunta 25', 'Respuesta 25', NOW(), NOW()),
('Pregunta 26', 'Respuesta 26', NOW(), NOW()),
('Pregunta 27', 'Respuesta 27', NOW(), NOW()),
('Pregunta 28', 'Respuesta 28', NOW(), NOW()),
('Pregunta 29', 'Respuesta 29', NOW(), NOW()),
('Pregunta 30', 'Respuesta 30', NOW(), NOW()),
('Pregunta 31', 'Respuesta 31', NOW(), NOW()),
('Pregunta 32', 'Respuesta 32', NOW(), NOW()),
('Pregunta 33', 'Respuesta 33', NOW(), NOW()),
('Pregunta 34', 'Respuesta 34', NOW(), NOW()),
('Pregunta 35', 'Respuesta 35', NOW(), NOW()),
('Pregunta 36', 'Respuesta 36', NOW(), NOW()),
('Pregunta 37', 'Respuesta 37', NOW(), NOW()),
('Pregunta 38', 'Respuesta 38', NOW(), NOW()),
('Pregunta 39', 'Respuesta 39', NOW(), NOW()),
('Pregunta 40', 'Respuesta 40', NOW(), NOW()),
('Pregunta 41', 'Respuesta 41', NOW(), NOW()),
('Pregunta 42', 'Respuesta 42', NOW(), NOW()),
('Pregunta 43', 'Respuesta 43', NOW(), NOW()),
('Pregunta 44', 'Respuesta 44', NOW(), NOW()),
('Pregunta 45', 'Respuesta 45', NOW(), NOW()),
('Pregunta 46', 'Respuesta 46', NOW(), NOW()),
('Pregunta 47', 'Respuesta 47', NOW(), NOW()),
('Pregunta 48', 'Respuesta 48', NOW(), NOW()),
('Pregunta 49', 'Respuesta 49', NOW(), NOW()),
('Pregunta 50', 'Respuesta 50', NOW(), NOW());


INSERT INTO chats (usuario_id, fecha_inicio, estado)
VALUES
(1, NOW(), 'activo'),
(2, NOW(), 'finalizado'),
(3, NOW(), 'activo'),
(4, NOW(), 'finalizado'),
(5, NOW(), 'activo'),
(6, NOW(), 'cancelado'),
(7, NOW(), 'activo'),
(8, NOW(), 'finalizado'),
(9, NOW(), 'activo'),
(10, NOW(), 'activo'),
(11, NOW(), 'finalizado'),
(12, NOW(), 'activo'),
(13, NOW(), 'cancelado'),
(14, NOW(), 'activo'),
(15, NOW(), 'finalizado'),
(16, NOW(), 'activo'),
(17, NOW(), 'activo'),
(18, NOW(), 'finalizado'),
(19, NOW(), 'activo'),
(20, NOW(), 'cancelado'),
(NULL, NOW(), 'activo'),
(NULL, NOW(), 'finalizado'),
(23, NOW(), 'activo'),
(24, NOW(), 'activo'),
(25, NOW(), 'finalizado'),
(26, NOW(), 'activo'),
(27, NOW(), 'cancelado'),
(28, NOW(), 'activo'),
(29, NOW(), 'activo'),
(30, NOW(), 'finalizado'),
(31, NOW(), 'activo'),
(32, NOW(), 'activo'),
(33, NOW(), 'cancelado'),
(34, NOW(), 'finalizado'),
(35, NOW(), 'activo'),
(36, NOW(), 'activo'),
(37, NOW(), 'finalizado'),
(38, NOW(), 'activo'),
(39, NOW(), 'activo'),
(40, NOW(), 'cancelado'),
(41, NOW(), 'finalizado'),
(42, NOW(), 'activo'),
(43, NOW(), 'activo'),
(44, NOW(), 'finalizado'),
(45, NOW(), 'activo'),
(46, NOW(), 'activo'),
(47, NOW(), 'cancelado'),
(48, NOW(), 'finalizado'),
(49, NOW(), 'activo'),
(50, NOW(), 'activo');


INSERT INTO chat_messages (chat_id, usuario_id, remitente, mensaje, fecha_envio)
VALUES
(1, 1, 'usuario', 'Hola, necesito ayuda con mis notas.', NOW()),
(1, 1, 'bot', 'Claro, para consultar tus notas, accede a tu perfil.', NOW()),
(2, 2, 'usuario', '¿Cómo veo mi horario?', NOW()),
(2, 2, 'bot', 'Tu horario se encuentra en el módulo de horarios.', NOW()),
(3, 3, 'usuario', '¿Cuánto debo pagar de pensión?', NOW()),
(3, 3, 'bot', 'El monto se muestra en el módulo de pagos.', NOW()),
(4, NULL, 'usuario', 'Tengo duda sobre mi curso.', NOW()),
(4, NULL, 'bot', 'Por favor, especifica tu consulta sobre el curso.', NOW()),
(5, 5, 'usuario', '¿Cómo actualizo mis datos personales?', NOW()),
(5, 5, 'bot', 'Puedes actualizar tus datos en tu perfil.', NOW()),
(6, 6, 'usuario', '¿Qué cursos están disponibles?', NOW()),
(6, 6, 'bot', 'Consulta el módulo de cursos para ver la oferta académica.', NOW()),
(7, 7, 'usuario', 'Necesito revisar mis asistencias.', NOW()),
(7, 7, 'bot', 'Tus asistencias se encuentran en el módulo correspondiente.', NOW()),
(8, 8, 'usuario', '¿Cómo contacto a mi profesor?', NOW()),
(8, 8, 'bot', 'Los datos de contacto de tu profesor están en el módulo de cursos.', NOW()),
(9, 9, 'usuario', '¿Cuáles son los requisitos de admisión?', NOW()),
(9, 9, 'bot', 'Consulta el apartado de admisiones para conocer los requisitos.', NOW()),
(10, 10, 'usuario', '¿Puedo ver mis reportes?', NOW()),
(10, 10, 'bot', 'Sí, los reportes están disponibles en tu panel.', NOW()),
(11, 11, 'usuario', 'Mensaje de prueba 11', NOW()),
(11, 11, 'bot', 'Respuesta de prueba 11', NOW()),
(12, 12, 'usuario', 'Mensaje de prueba 12', NOW()),
(12, 12, 'bot', 'Respuesta de prueba 12', NOW()),
(13, 13, 'usuario', 'Mensaje de prueba 13', NOW()),
(13, 13, 'bot', 'Respuesta de prueba 13', NOW()),
(14, 14, 'usuario', 'Mensaje de prueba 14', NOW()),
(14, 14, 'bot', 'Respuesta de prueba 14', NOW()),
(15, 15, 'usuario', 'Mensaje de prueba 15', NOW()),
(15, 15, 'bot', 'Respuesta de prueba 15', NOW()),
(16, 16, 'usuario', 'Mensaje de prueba 16', NOW()),
(16, 16, 'bot', 'Respuesta de prueba 16', NOW()),
(17, 17, 'usuario', 'Mensaje de prueba 17', NOW()),
(17, 17, 'bot', 'Respuesta de prueba 17', NOW()),
(18, 18, 'usuario', 'Mensaje de prueba 18', NOW()),
(18, 18, 'bot', 'Respuesta de prueba 18', NOW()),
(19, 19, 'usuario', 'Mensaje de prueba 19', NOW()),
(19, 19, 'bot', 'Respuesta de prueba 19', NOW()),
(20, 20, 'usuario', 'Mensaje de prueba 20', NOW()),
(20, 20, 'bot', 'Respuesta de prueba 20', NOW()),
(21, 21, 'usuario', 'Mensaje de prueba 21', NOW()),
(21, 21, 'bot', 'Respuesta de prueba 21', NOW()),
(22, 22, 'usuario', 'Mensaje de prueba 22', NOW()),
(22, 22, 'bot', 'Respuesta de prueba 22', NOW()),
(23, 23, 'usuario', 'Mensaje de prueba 23', NOW()),
(23, 23, 'bot', 'Respuesta de prueba 23', NOW()),
(24, 24, 'usuario', 'Mensaje de prueba 24', NOW()),
(24, 24, 'bot', 'Respuesta de prueba 24', NOW()),
(25, 25, 'usuario', 'Mensaje de prueba 25', NOW()),
(25, 25, 'bot', 'Respuesta de prueba 25', NOW()),
(26, 26, 'usuario', 'Mensaje de prueba 26', NOW()),
(26, 26, 'bot', 'Respuesta de prueba 26', NOW()),
(27, 27, 'usuario', 'Mensaje de prueba 27', NOW()),
(27, 27, 'bot', 'Respuesta de prueba 27', NOW()),
(28, 28, 'usuario', 'Mensaje de prueba 28', NOW()),
(28, 28, 'bot', 'Respuesta de prueba 28', NOW()),
(29, 29, 'usuario', 'Mensaje de prueba 29', NOW()),
(29, 29, 'bot', 'Respuesta de prueba 29', NOW()),
(30, 30, 'usuario', 'Mensaje de prueba 30', NOW()),
(30, 30, 'bot', 'Respuesta de prueba 30', NOW()),
(31, 31, 'usuario', 'Mensaje de prueba 31', NOW()),
(31, 31, 'bot', 'Respuesta de prueba 31', NOW()),
(32, 32, 'usuario', 'Mensaje de prueba 32', NOW()),
(32, 32, 'bot', 'Respuesta de prueba 32', NOW()),
(33, 33, 'usuario', 'Mensaje de prueba 33', NOW()),
(33, 33, 'bot', 'Respuesta de prueba 33', NOW()),
(34, 34, 'usuario', 'Mensaje de prueba 34', NOW()),
(34, 34, 'bot', 'Respuesta de prueba 34', NOW()),
(35, 35, 'usuario', 'Mensaje de prueba 35', NOW()),
(35, 35, 'bot', 'Respuesta de prueba 35', NOW()),
(36, 36, 'usuario', 'Mensaje de prueba 36', NOW()),
(36, 36, 'bot', 'Respuesta de prueba 36', NOW()),
(37, 37, 'usuario', 'Mensaje de prueba 37', NOW()),
(37, 37, 'bot', 'Respuesta de prueba 37', NOW()),
(38, 38, 'usuario', 'Mensaje de prueba 38', NOW()),
(38, 38, 'bot', 'Respuesta de prueba 38', NOW()),
(39, 39, 'usuario', 'Mensaje de prueba 39', NOW()),
(39, 39, 'bot', 'Respuesta de prueba 39', NOW()),
(40, 40, 'usuario', 'Mensaje de prueba 40', NOW()),
(40, 40, 'bot', 'Respuesta de prueba 40', NOW()),
(41, 41, 'usuario', 'Mensaje de prueba 41', NOW()),
(41, 41, 'bot', 'Respuesta de prueba 41', NOW()),
(42, 42, 'usuario', 'Mensaje de prueba 42', NOW()),
(42, 42, 'bot', 'Respuesta de prueba 42', NOW()),
(43, 43, 'usuario', 'Mensaje de prueba 43', NOW()),
(43, 43, 'bot', 'Respuesta de prueba 43', NOW()),
(44, 44, 'usuario', 'Mensaje de prueba 44', NOW()),
(44, 44, 'bot', 'Respuesta de prueba 44', NOW()),
(45, 45, 'usuario', 'Mensaje de prueba 45', NOW()),
(45, 45, 'bot', 'Respuesta de prueba 45', NOW()),
(46, 46, 'usuario', 'Mensaje de prueba 46', NOW()),
(46, 46, 'bot', 'Respuesta de prueba 46', NOW()),
(47, 47, 'usuario', 'Mensaje de prueba 47', NOW()),
(47, 47, 'bot', 'Respuesta de prueba 47', NOW()),
(48, 48, 'usuario', 'Mensaje de prueba 48', NOW()),
(48, 48, 'bot', 'Respuesta de prueba 48', NOW()),
(49, 49, 'usuario', 'Mensaje de prueba 49', NOW()),
(49, 49, 'bot', 'Respuesta de prueba 49', NOW()),
(50, 50, 'usuario', 'Mensaje de prueba 50', NOW()),
(50, 50, 'bot', 'Respuesta de prueba 50', NOW());
